import { useEffect, useMemo } from "react";
import Box from "@mui/material/Box";
import { GridRowsProp, GridColTypeDef } from "@mui/x-data-grid";
import { Datagrid } from "../components/Datagrid";
import { PageTitle } from "../components/PageTitle";
import { renderProgress } from "../components/ProgressBar";
import { renderAvatar } from "../components/GridAvatar";
import { renderEditButton } from "../components/GridEditButton";
import { dateFormatter } from "../utils/utils";
import { useDispatch, useSelector } from "react-redux";
import { setButtonProps } from "../actions/Actions";

const rows: GridRowsProp = [
  {
    carPlate: "ABC123",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Michael Espinosa",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.9,
  },
  {
    carPlate: "DDD123",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.5,
  },
  {
    carPlate: "DDD124",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.25,
  },
  {
    carPlate: "DDD125",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.2,
  },
  {
    carPlate: "DDD126",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.2,
  },
  {
    carPlate: "DDD127",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.2,
  },
  {
    carPlate: "DDD128",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.2,
  },
  {
    carPlate: "DDD129",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.2,
  },
  {
    carPlate: "DDD110",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.2,
  },
  {
    carPlate: "DDD111",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.2,
  },
  {
    carPlate: "DDD112",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.2,
  },
  {
    carPlate: "DDD113",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.2,
  },
  {
    carPlate: "DDD114",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.2,
  },
  {
    carPlate: "DDD115",
    brandId: 2,
    vehicleTypeId: 3,
    lineId: 2,
    bodyWorkId: 3,
    color: "azul",
    modelYear: 2015,
    serialNumber: "asdasdasd123",
    netWeight: 2000,
    emptyWeight: 1000,
    repoweredTo: 2018,
    axles: 2,
    propertyCard: "asdaeeer4545",
    fuelTypeId: 2,
    observations: "N/A",
    frontPhoto:
      "https://image.shutterstock.com/image-photo/hoofddorpmarch-14-2020-mercedes-started-600w-1708023739.jpg",
    backPhoto: "http://localhost:3000/api/v1/products",
    createdAt: "2022-08-18T03:58:26.305Z",
    updatedAt: "2022-08-18T03:58:26.305Z",
    driver: "Daniel Gonzalez",
    soatDueDate: "2022-08-18T03:58:26.305Z",
    technoDueDate: "2022-08-18T03:58:26.305Z",
    status: 0.2,
  },
];

// const dateFormatter = new Intl.DateTimeFormat("es-CO", {
//   year: "numeric",
//   month: "numeric",
//   day: "numeric",
//   timeZone: "America/Bogota",
// });

const commonProps: GridColTypeDef = {
  align: "center",
  headerAlign: "center",
};

const soatDueDate: GridColTypeDef = {
  headerName: "SOAT",
  type: "date",
  valueGetter: ({ value }) => dateFormatter.format(new Date(value)),
  flex: 0.7,
  ...commonProps,
};

const technoDueDate: GridColTypeDef = {
  headerName: "Tecnomecanica",
  flex: 0.7,
  type: "date",
  valueGetter: ({ value }) => dateFormatter.format(new Date(value)),
  ...commonProps,
};

const Vehicles = () => {
  const buttonProps = useSelector((state: any) => state.buttonProps);
  const dispatch = useDispatch();
  console.log(buttonProps);

  useEffect(() => {
    const createButton = {
      title: "Crear Vehículos",
      url: "crearVehiculo",
    };

    dispatch(setButtonProps(createButton));
  }, []);

  const columns = useMemo(
    () => [
      {
        field: "frontPhoto",
        headerName: "",
        filterable: false,
        disableColumnMenu: true,
        sortable: false,
        flex: 0.2,
        renderCell: renderAvatar,
        ...commonProps,
      },
      {
        field: "carPlate",
        headerName: "Placa",
        flex: 0.5,
        ...commonProps,
      },
      {
        field: "driver",
        headerName: "Conductor asignado",
        flex: 1,
        ...commonProps,
      },
      {
        field: "soatDueDate",
        ...soatDueDate,
      },
      {
        field: "technoDueDate",
        ...technoDueDate,
      },
      {
        field: "status",
        headerName: "Cumplimiento Documentación",
        flex: 0.4,
        align: "center",
        renderCell: renderProgress,
        ...commonProps,
      },
      {
        field: "actions",
        headerName: "",
        type: "actions",
        flex: 0.1,
        renderCell: renderEditButton,
        ...commonProps,
      },
    ],
    []
  );

  return (
    <Box>
      <Box sx={{ display: "flex", justifyContent: "space-between" }}>
        <PageTitle title="Vehículos" />
      </Box>
      <Datagrid rows={rows} cols={columns} rowId="carPlate" />
    </Box>
  );
};

export { Vehicles };
